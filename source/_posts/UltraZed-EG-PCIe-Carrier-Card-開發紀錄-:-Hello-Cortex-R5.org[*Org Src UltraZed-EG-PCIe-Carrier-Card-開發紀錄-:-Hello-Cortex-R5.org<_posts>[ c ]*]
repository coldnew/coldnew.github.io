
#define LED_CHANNEL 2

XGpio led;

int main()
{
    // skip ...
    print("Hello Cortex-R5\n\r");

    // Initialize LEDs
    ret = XGpio_Initialize(&led, XPAR_GPIO_0_DEVICE_ID);
    if (ret != XST_SUCCESS)
        return XST_FAILURE;

    // setup gpio direction to OUT
    XGpio_SetDataDirection(&led, LED_CHANNEL, 0xff);

    // polling the SW2 ~ SW4 input result
    while (1) {
        int val = XGpio_DiscreteRead(&sw, 0x1);
        switch(val) {
            case 0x4:
                xil_printf("SW 4 pressed!\n\r");
                XGpio_DiscreteWrite(&led, LED_CHANNEL, 0x4); // D14: ON
                break;
            case 0x1:
                xil_printf("SW 3 pressed!\n\r");
                XGpio_DiscreteWrite(&led, LED_CHANNEL, 0x2); // D13: ON
                break;
            case 0x2:
                xil_printf("SW 2 pressed!\n\r");
                XGpio_DiscreteWrite(&led, LED_CHANNEL, 0x1); // D12: ON
                break;
        }
        // this sleep is act as some sort of debounce, sleep 10ms
        usleep(100 * 1000);
    }

    // skip ...
}
