<!doctype html>
<html class="theme-next use-motion theme-next-mist">
  <head>
  

<script type="text/javascript" src="/vendors/jquery/dist/jquery.min.js"></script>
<link rel="stylesheet" href="/vendors/bootstrap/dist/css/bootstrap.min.css" type="text/css">
<script type="text/javascript" src="/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/responsive.js"></script>

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />


  <meta name="google-site-verification" content="2KupV-VpD04LYh25td4WXU0FNSfAQUQjYs13zPnAXls" />



  <meta name="msvalidate.01" content="A2F329127555BDD555949FFD886CFF2B" />



  <meta name="baidu-site-verification" content="fwxmwVqWtK,5z58vsAQKG" />





  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>




  <meta name="keywords" content="fpga,xilinx,zynqmp,ultrazed-3eg-pciecc," />



  <link rel="alternate" href="/rss.xml" title="coldnew&#39;s blog" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />


<meta name="description" content="最近入手了 UltraZed-EG PCIe Carrier Card ，這是一款基於 UltraZed-EG 核心板進行延伸的開發板，和 Zybo Board 類似，是一款同時具有 Xilinx FPGA 並且包含了 ARM CPU 的開發平台。    但是不同的是，此開發板主板採用的核心為 Xilinx UltraScale+ MPSoC ，這一款具有 Cortex-A53 以及 Mali">
<meta property="og:type" content="article">
<meta property="og:title" content="UltraZed-EG PCIe Carrier Card 開發紀錄: 硬體認識">
<meta property="og:url" content="https://coldnew.github.io/d1be86fb/index.html">
<meta property="og:site_name" content="coldnew&#39;s blog">
<meta property="og:description" content="最近入手了 UltraZed-EG PCIe Carrier Card ，這是一款基於 UltraZed-EG 核心板進行延伸的開發板，和 Zybo Board 類似，是一款同時具有 Xilinx FPGA 並且包含了 ARM CPU 的開發平台。    但是不同的是，此開發板主板採用的核心為 Xilinx UltraScale+ MPSoC ，這一款具有 Cortex-A53 以及 Mali">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/overview.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/mpsoc.jpg">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/som.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/boot.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/eg_qspi.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/eg_emmc.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/bd.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/o4.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/ps_usb.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/usb_id.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/ps_rj45.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/sata3.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/usb_uart.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/sdx.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/ledd1.jpg">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/pl_leds.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/sw4-5.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/som_reset.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/pspmod1.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/pl_pmod.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/fmc.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/ps_idt.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/ps_idt_sel.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/ps_eeprom.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/jtag.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/jtag_sel.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/dp.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/ar67462.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/pcie.png">
<meta property="og:image" content="https://coldnew.github.io/d1be86fb/p3.png">
<meta property="article:published_time" content="2018-08-26T13:51:00.000Z">
<meta property="article:modified_time" content="2018-12-02T03:41:04.720Z">
<meta property="article:author" content="Yen-Chin, Lee">
<meta property="article:tag" content="fpga">
<meta property="article:tag" content="xilinx">
<meta property="article:tag" content="zynqmp">
<meta property="article:tag" content="ultrazed-3eg-pciecc">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://coldnew.github.io/d1be86fb/overview.png">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'post'
  };
</script>

  <title> UltraZed-EG PCIe Carrier Card 開發紀錄: 硬體認識 | coldnew&#39;s blog </title>
<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="https://schema.org/WebPage" lang="zh-tw,en,default">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="https://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode" target="_blank" rel="noopener">
      <img src="https://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->

  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42122243-1', 'auto');
  ga('send', 'pageview');
</script>




  <div class="container-fluid one-column page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="https://schema.org/WPHeader">
      <div class="header-inner"><link rel="canonical" href="https://coldnew.github.io/d1be86fb/" />
<h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-next-logo"></i>
      </span>
      <span class="site-title">coldnew&#39;s blog</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-next-home"></i> <br />
            首頁
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            <i class="menu-item-icon icon-next-categories"></i> <br />
            分類
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            歸檔
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            標籤
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content"> 

  <div id="posts" class="posts-expand">
    

  <article class="post post-type-normal " itemscope itemtype="https://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              UltraZed-EG PCIe Carrier Card 開發紀錄: 硬體認識
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          最後更新
          <time itemprop="dateCreated" datetime="2018-12-02T03:41:04+00:00" content="2018-12-02">
            2018-12-02
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分類於
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/ultrazed-3eg-pciecc/" itemprop="url" rel="index">
                  <span itemprop="name">UltraZed-EG PCIe Carrier Card 開發紀錄</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        <span itemprop="articleBody"><div id="content">
<p>
最近入手了 <a href="http://ultrazed.org/product/ultrazed-eg-pcie-carrier-card" target="_blank" rel="noopener">UltraZed-EG PCIe Carrier Card</a> ，這是一款基於 <a href="http://zedboard.org/product/ultrazed-EG" target="_blank" rel="noopener">UltraZed-EG</a> 核心板進行延伸的開發板，和 <a href="https://store.digilentinc.com/zybo-zynq-7000-arm-fpga-soc-trainer-board/" target="_blank" rel="noopener">Zybo Board</a> 類似，是一款同時具有 Xilinx FPGA 並且包含了 ARM CPU 的開發平台。
</p>

<p>
但是不同的是，此開發板主板採用的核心為 <a href="https://www.xilinx.com/products/silicon-devices/soc/zynq-ultrascale-mpsoc.html" target="_blank" rel="noopener">Xilinx UltraScale+ MPSoC</a> ，這一款具有 Cortex-A53 以及 Mali-400 的 FPGA 晶片，補足了 Zynq-7000 缺少 GPU 的不足。
</p>

<p>
為了了解這塊開發板，我做了一些整理，讓我們一樣從硬體以及週邊開始吧～
</p>

<a id="more"></a>

<div id="outline-container-org1e5c43b" class="outline-2">
<h2 id="org1e5c43b">開發板概觀</h2>
<div class="outline-text-2" id="text-org1e5c43b">
<p>
首先，這一整塊開發板是 <code>核心板</code> 搭配 <code>擴充板</code> 組合在一起的產品，因此我們應該要先理解核心板的功能，再來看擴充板基於核心板的腳位，做了哪些延伸。
</p>


<div class="figure">
<p><img src="overview.png"  />
</p>
</div>

<p>
另外，要注意的是，核心板是可以被替換的，在我的文章中我使用的是 <a href="http://zedboard.org/product/ultrazed-EG" target="_blank" rel="noopener">UltraZed-EG</a> 。
</p>
</div>
</div>

<div id="outline-container-org24082e6" class="outline-2">
<h2 id="org24082e6">UltraZed-EG</h2>
<div class="outline-text-2" id="text-org24082e6">
<p>
<a href="http://zedboard.org/product/ultrazed-EG" target="_blank" rel="noopener">UltraZed-EG</a> 是包含了 Xilinx FGPA 的核心板(System-On-Module, SOM)，中間的核心晶片為 <a href="https://www.xilinx.com/products/silicon-devices/soc/zynq-ultrascale-mpsoc.html" target="_blank" rel="noopener">Xilinx UltraScale+ MPSoC</a> 系列的 <code>Zynq UltraScale+ EG (XCZU3EG-SFVA625)</code> ，這一系列不同版本的晶片差異如下:
</p>


<div class="figure">
<p><img src="mpsoc.jpg"  width="60%" />
</p>
</div>

<p>
由於我的核心板是 <a href="http://zedboard.org/product/ultrazed-EG" target="_blank" rel="noopener">UltraZed-EG</a>，因此讓我們直接看這一款的方塊圖，好來理解其有哪些功能:
</p>


<div class="figure">
<p><img src="som.png"  />
</p>
</div>

<p>
我們可以看到 Zynq UltraScale+ EG 除了具有 ARM Cortex-A53 可以用來跑複雜的作業系統 (比如 Linux), 搭配 Mali-400 GPU 同時也可以跑具有 3D 效果的程式。此外，這顆晶片還具有兩個 ARM Cortex-R5 可以讓你用來處理對反應時間有嚴格要求(Real-Time) 的工作。
</p>

<p>
那假設我們使用 Linux 或是 Android 的話，要怎樣讓 Cortex-A53 的 Linux/Andriod 與 Cortex-R5 的 RTOS 溝通呢？這個時候就可以使用 Xilinx 這幾年開源的 <a href="https://github.com/OpenAMP/open-amp" target="_blank" rel="noopener">OpenAMP</a> 框架來達到跨 CPU/OS 的通訊。
</p>

<p>
除了 ARM 的 CPU 外，因為這顆晶片同時也是 FPGA 晶片，當我們需要實做比如快速的影像處理、資訊偵測的時候，就可以透過採用 FGPA 進行我們的影像處理/分析等功能，再將資訊轉發給 Linux/Android 去做後續的資訊描繪。
</p>

<p>
簡單的來說，這一款具有 SoC 的 FPGA 可以達成非常多的產品需求 (不考慮成本的話啦^^)
</p>

<p>
由於核心板 (System-On-Module, SOM) 的任務就是把 SoC 的接腳拉出，讓開發者自行開發延伸板後將其合併就可以變成一個完整的產品，因此核心板本身有的週邊很少，在這邊我們只關注我們感興趣的週邊即可~
</p>

<p>
關於 <a href="http://zedboard.org/product/ultrazed-EG" target="_blank" rel="noopener">UltraZed-EG</a>, 可以透過 <a href="http://zedboard.org/sites/default/files/documentations/5264-UG-AES-ZU3EGES-1-SOM-G-v1-1-V1.pdf" target="_blank" rel="noopener">UltraZed-EG SOM Hardware User Guide</a> 來更加了解其具有的功能。
</p>
</div>

<div id="outline-container-orgcc8ba3c" class="outline-3">
<h3 id="orgcc8ba3c">SW2</h3>
<div class="outline-text-3" id="text-orgcc8ba3c">
<p>
首先，這塊核心板最重要的就是用來設定開機模式的 <code>SW2</code>  這個指撥開關。整塊板子的開機行為都會根據你的不同設定而改變，在後續文章裡面，我大部分都會選用 <code>SD1/MMC33</code> 這種透過 MicroSD 卡來進行開機的模式。
</p>


<div class="figure">
<p><img src="boot.png"  />
</p>
</div>
</div>
</div>

<div id="outline-container-orgef7ae94" class="outline-3">
<h3 id="orgef7ae94">QSPI</h3>
<div class="outline-text-3" id="text-orgef7ae94">
<p>
核心板上有 2 顆 Micron QPSI MT25QU256ABAIEW7-0SIT NOR Flash, 不過我找不到相關的 datasheet&#x2026;.
</p>

<p>
我們可以透過 SPI 界面來將資料讀寫進這兩顆 NOR Flash 去。
</p>


<div class="figure">
<p><img src="eg_qspi.png"  />
</p>
</div>

<p>
注意到如果你是要自己外接 SPI Flash 的話，也許最好看看 <a href="https://www.micron.com/resource-details/720e1570-15d9-4ef4-8c45-4bd133915f0b" target="_blank" rel="noopener">Micron Memory Support for Xilinx Platforms</a> 的說明，裡面會標注可以用於 Xilinx 平台上的 Flash 的型號。
</p>
</div>
</div>

<div id="outline-container-orgb7a85a3" class="outline-3">
<h3 id="orgb7a85a3">eMMC</h3>
<div class="outline-text-3" id="text-orgb7a85a3">
<p>
核心板有一顆 <a href="https://www.micron.com/parts/nand-flash/managed-nand/mtfc8gakajcn-4m-it" target="_blank" rel="noopener">Micron MTFC8GAKAJCN-4M IT</a> eMMC 晶片，大小為 8GB，在預設的情況下這個 eMMC 會被當作是 <code>SD0</code> ，而擴充板的 MicroSD 卡則是會被當作 <code>SD1</code>
</p>


<div class="figure">
<p><img src="eg_emmc.png"  />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgba514f7" class="outline-2">
<h2 id="orgba514f7">UltraZed-EG PCIe Carrier Card</h2>
<div class="outline-text-2" id="text-orgba514f7">
<p>
本文使用的擴充板為 <a href="http://ultrazed.org/product/ultrazed-eg-pcie-carrier-card" target="_blank" rel="noopener">UltraZed PCIe Carrier Card</a>,  為 <a href="https://www.avnet.com" target="_blank" rel="noopener">AVNET</a> 公司所出品的延伸板。由於 <a href="http://zedboard.org/product/ultrazed-EG" target="_blank" rel="noopener">UltraZed-EG</a> 本身只是將該 SoC 最基本的功能組裝在一起，實際上需要使用比如 USB、PCIe 等週邊的時候，就會需要透過延伸板來增加 I/O 的連接。
</p>

<p>
要了解這片板子，首先我們需要知道其 I/O 對應以及一些基本的週邊，因此最好是先從  <a href="http://zedboard.org/sites/default/files/documentations/5265-AES-UG-ZU-PCIECC-G-UltraZed-EG-PCIe-v1_1.pdf" target="_blank" rel="noopener">UltraZed PCIe Carrier Card Hardware User Guide</a> 來開始看起。
</p>
</div>

<div id="outline-container-orgdf38797" class="outline-3">
<h3 id="orgdf38797">概觀</h3>
<div class="outline-text-3" id="text-orgdf38797">
<p>
我們先從 <a href="http://ultrazed.org/product/ultrazed-eg-pcie-carrier-card" target="_blank" rel="noopener">UltraZed PCIe Carrier Card</a> 的外觀來了解這片板子的大概功能，之後再透過電路等資訊來看要如何使用這片板子。
</p>


<div class="figure">
<p><img src="bd.png"  />
</p>
</div>

<p>
由於這塊板子的週邊可以區分為給 Cortex-A53 使用的部份 (Processing System, PS) 和給可程式邏輯區 (Programmable Logic, PL) 控制的兩個區塊，在搭配一些其他的週邊，因此我們可以用以下這張圖來看週邊的使用以及分佈。
</p>


<div class="figure">
<p><img src="o4.png"  />
</p>
</div>

<p>
了解了基本的週邊後，就讓我們來一個一個看吧~
</p>
</div>
</div>

<div id="outline-container-org3cbf9e6" class="outline-3">
<h3 id="org3cbf9e6">USB 2.0/3.0 (J4)</h3>
<div class="outline-text-3" id="text-org3cbf9e6">
<p>
USB 位於 <code>J4</code> 的位置，為支援 USB 2.0/3.0 Host/Device 以及 OTG 的設備。我們可以透過調整 JP2, JP3 以及 JP5 來設定我們對這塊板子上的 USB 的使用需求。
</p>


<div class="figure">
<p><img src="ps_usb.png"  />
</p>
</div>

<p>
當設定 USB 為 OTG 的形式時，我們則可以透過修改 <code>JP4</code> 來指定 OTG 的運作模式
</p>


<div class="figure">
<p><img src="usb_id.png"  width="40%" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgeef68b5" class="outline-3">
<h3 id="orgeef68b5">1000Mb/s 網路</h3>
<div class="outline-text-3" id="text-orgeef68b5">
<p>
由於 <a href="http://zedboard.org/product/ultrazed-EG" target="_blank" rel="noopener">UltraZed-EG</a> 已經做好了 MAC 和 PHY (<a href="http://www.ti.com/lit/ds/symlink/dp83867ir.pdf" target="_blank" rel="noopener">DP83867</a>) 的連線，因此 <a href="http://ultrazed.org/product/ultrazed-eg-pcie-carrier-card" target="_blank" rel="noopener">UltraZed PCIe Carrier Card</a> 上的網路相關電路是直接將核心板的接線拉出，直接連線到 <a href="https://www.belfuse.com/resources/ICMs/ICMs%2520Drawings/L829-1J1T-43.pdf" target="_blank" rel="noopener">L829-1J1t-43G</a> 這個 RJ45 連接器來用。
</p>


<div class="figure">
<p><img src="ps_rj45.png"  />
</p>
</div>
</div>
</div>

<div id="outline-container-orgbe8f607" class="outline-3">
<h3 id="orgbe8f607">SATA3 Host</h3>
<div class="outline-text-3" id="text-orgbe8f607">
<p>
在 <a href="http://ultrazed.org/product/ultrazed-eg-pcie-carrier-card" target="_blank" rel="noopener">UltraZed PCIe Carrier Card</a> 上有一個 SATA3 Host 界面連接到處理器系統(Processing Syste, PS)，我們可以在這邊接上外接硬碟擴充儲存空間，該界面傳輸速度最快可以到達 6 Gb/s。
</p>


<div class="figure">
<p><img src="sata3.png"  width="60%" />
</p>
</div>
</div>
</div>

<div id="outline-container-orge50f3b6" class="outline-3">
<h3 id="orge50f3b6">USB 轉 UART (J2)</h3>
<div class="outline-text-3" id="text-orge50f3b6">
<p>
位於 <code>J2</code> 的 micro USB 接頭，會經過 USB 轉 UART 晶片 <a href="https://www.silabs.com/documents/public/data-sheets/CP2105.pdf" target="_blank" rel="noopener">CP2105</a> 而變成兩個 UART 設備。
</p>

<p>
接到 Linux 上，會得到 <code>/dev/ttyUSB0</code> 和 <code>/dev/ttyUSB1</code> 兩個設備，預設都是從 <code>/dev/ttyUSB1</code> 輸出資訊。
</p>

<p>
這兩個 UART 對應到的 MIO (Multiplexed Input Output) 如下表所述：
</p>


<div class="figure">
<p><img src="usb_uart.png"  />
</p>
</div>

<p>
從上圖的 <code>MIO</code> 對應表可以發現到，之所以預設從 <code>/dev/ttyUSB1</code> 輸出，是因為這塊板子把 SoC 上的 <code>ps_uart0</code> 接到了 MIO_34 和 MIO_35 上，也因此實際上的 UART 對應表如下：
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">MPSoC PS</th>
<th scope="col" class="org-left">MIO</th>
<th scope="col" class="org-left">Linux</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">ps_uart_0</td>
<td class="org-left">MIO_32 (TX), MIO_33 (RX)</td>
<td class="org-left">/dev/ttyUSB1</td>
</tr>

<tr>
<td class="org-left">ps_uart_1</td>
<td class="org-left">MIO_35 (TX), MIO_34 (RX)</td>
<td class="org-left">/dev/ttyUSB0</td>
</tr>
</tbody>
</table>

<p>
總之如果有透過 UART 輸出訊息，又奇怪怎樣都看不到的話，兩個 UART 都接收看看就對了 ^_^
</p>
</div>
</div>

<div id="outline-container-orgdc1c982" class="outline-3">
<h3 id="orgdc1c982">MicroSD 卡座 (J1)</h3>
<div class="outline-text-3" id="text-orgdc1c982">
<p>
位於 <code>J1</code> 的 MicroSD 卡座提供了讓我們透過 SD 卡開機的用途，而附近的 <code>JP1</code> 短路的情況則是打開了 SD 卡的 <code>write proteced</code> 的功能。
</p>

<p>
注意到：當要透過 SD 卡開機的時候，別忘記修改主板上 <code>SW2</code> 的 DIP Switch
</p>


<div class="figure">
<p><img src="sdx.png"  />
</p>
</div>
</div>
</div>

<div id="outline-container-orgfd98078" class="outline-3">
<h3 id="orgfd98078">User LED D1</h3>
<div class="outline-text-3" id="text-orgfd98078">
<p>
位於 <code>D1</code> 的 LED 是直接接到處理器系統 (Processing System, PS) 的 <code>MIO26</code> 上，這是這塊板子唯一一個使用者可以透過處理器系統(Processing System, PS)去控制的 LED。
</p>


<div class="figure">
<p><img src="ledd1.jpg"  width="40%" />
</p>
</div>
</div>
</div>

<div id="outline-container-org209a8a2" class="outline-3">
<h3 id="org209a8a2">User LED D12 ~ D19</h3>
<div class="outline-text-3" id="text-org209a8a2">
<p>
和 LED D1 不同，D12 ~ D19 的 LED 是位於可程式邏輯區(Programming Logic, PL)上，因此我們需要透過 <code>AXI_GPIO</code> 模組讓 Cortex-A53 能夠對其進行控制。
</p>


<div class="figure">
<p><img src="pl_leds.png"  />
</p>
</div>
</div>
</div>

<div id="outline-container-orgc328f6a" class="outline-3">
<h3 id="orgc328f6a">User Switch SW1 ~ SW5</h3>
<div class="outline-text-3" id="text-orgc328f6a">
<p>
除了 LED 外，這塊擴充板內建了 4 個無段按鈕 SW1 ~ SW4 以及一個 DIP Switch SW5 提供使用者輸入訊號使用，這幾個輸入源皆是接在可程式邏輯區 (Programming Logic, PL) 的位置，一般來說我們會透過 <code>AXI_GPIO</code> 模組讓 ARM Cortex-A53 可以使用這些輸入源。
</p>


<div class="figure">
<p><img src="sw4-5.png"  />
</p>
</div>
</div>
</div>

<div id="outline-container-orgfcb3838" class="outline-3">
<h3 id="orgfcb3838">SOM Reset Input (SW6)</h3>
<div class="outline-text-3" id="text-orgfcb3838">
<p>
<code>SW6</code> 是用來重置 <a href="http://zedboard.org/product/ultrazed-EG" target="_blank" rel="noopener">UltraZed-EG</a> 用的無段按鈕，和電腦上使用的 Restart 按鈕功用一樣，都是在不完全斷電的情況下對 CPU 進行重置的動做。
</p>


<div class="figure">
<p><img src="som_reset.png"  width="60%" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgd365d61" class="outline-3">
<h3 id="orgd365d61">PS PMOD (JP5)</h3>
<div class="outline-text-3" id="text-orgd365d61">
<p>
位於 <code>JP5</code> 位置的 PMOD 腳位是直接連接到 ZynqMP 的 MIO (Multiplexed Input Output) 腳位上的，因此這個 PMOD 是交由處理器系統 (Processing System, PS) 來進行控制。
</p>

<p>
由於 MIO (Multiplexed Input Output) 具有可切換的功能，因此這幾隻 MIO 可以根據用途變成 SPI、I2C、UART 等不同的接腳，詳細資訊請參考 <a href="https://www.xilinx.com/support/documentation/user_guides/ug1085-zynq-ultrascale-trm.pdf" target="_blank" rel="noopener">ug1085 - Zynq UntraScale+ Device Technical Reference Manual</a> 的 Chapter 28 對於 Multiplexed I/O 的說明。
</p>


<div class="figure">
<p><img src="pspmod1.png"  />
</p>
</div>
</div>
</div>

<div id="outline-container-org71fd29f" class="outline-3">
<h3 id="org71fd29f">PL PMOD (JA, JB)</h3>
<div class="outline-text-3" id="text-org71fd29f">
<p>
如果想要更有彈性一點的 I/O 的話，我們則可以透過 PMOD JA 和 JB 來對我們的輸入/出進行控制。
</p>

<p>
PMOD JA 和 JB 是連接在可程式邏輯區 (Programming Logic, PL) 上的，也意味著我們可以透過 Verilog 等硬體描述語言自訂我們自己的模組，然後在透過遮些 PMOD 的腳位進行輸出 (ex: 撰寫 UART 模組並將 TX/RX 從 PMOD 導出)
</p>

<p>
注意到這邊 I/O 的電壓準位為 <code>3.3V</code> ，如果要連接更低/高電壓的設備的話則需要做些保護才行。
</p>


<div class="figure">
<p><img src="pl_pmod.png"  />
</p>
</div>
</div>
</div>

<div id="outline-container-org759eb3b" class="outline-3">
<h3 id="org759eb3b">FMC Header JX1, 2 CON1A-E</h3>
<div class="outline-text-3" id="text-org759eb3b">
<p>
這塊板子上有一個 FMC (<a href="https://en.wikipedia.org/wiki/FPGA_Mezzanine_Card" target="_blank" rel="noopener">FPGA Mezzanine Card</a>) 界面，這是一種高速 I/O 界面，我們可以使用不同具有 FMC 界面的擴充板繼續擴充這塊板子的功能。
</p>

<p>
(有點類似 Altera DE2-115 上的 High Speed Mezzannie Card, HSMC 接口)
</p>

<p>
由於我並未有任何 FMC 界面的擴充板，因此這邊就不對其做多餘的介紹，只需要知道這個界面可以把一些 <a href="http://zedboard.org/product/ultrazed-EG" target="_blank" rel="noopener">UltraZed-EG</a> 並未用於這塊擴充板的腳位拉出，因此我們可以再接上別的擴充板繼續擴充。
</p>


<div class="figure">
<p><img src="fmc.png"  />
</p>
</div>
</div>
</div>

<div id="outline-container-org4f8c87b" class="outline-3">
<h3 id="org4f8c87b">Clock Generator (U5)</h3>
<div class="outline-text-3" id="text-org4f8c87b">
<p>
位於 <code>U5</code> 的 IC 為 <a href="https://www.mouser.tw/datasheet/2/464/IDT_5P49V5935_DST_20171101-1500296.pdf" target="_blank" rel="noopener">IDT 5P49V5935B521LTGI</a> ，是一個時脈產生器。該晶片透過 I2C 界面連接到處理器系統 (Processing System, PS)，其中 I2C 位址為
 <code>0xD4</code> 。
</p>

<p>
在這塊板子上，此晶片主要用途是產生 <a href="https://en.wikipedia.org/wiki/Low-voltage_differential_signaling" target="_blank" rel="noopener">LVDS (Low-voltage differential signaling)</a> 界面所需要的時脈，由於我沒有 LVDS 面板可以用，因此這邊也就只好先略過。
</p>


<div class="figure">
<p><img src="ps_idt.png"  />
</p>
</div>

<p>
如果需要調整輸出的時脈，則可以透過 JP6, JP7 和 JP8 進行調整，具體請見  <a href="http://zedboard.org/sites/default/files/documentations/5265-AES-UG-ZU-PCIECC-G-UltraZed-EG-PCIe-v1_1.pdf" target="_blank" rel="noopener">UltraZed PCIe Carrier Card Hardware User Guide.pdf</a>
</p>


<div class="figure">
<p><img src="ps_idt_sel.png"  />
</p>
</div>
</div>
</div>

<div id="outline-container-orgb2d4ec1" class="outline-3">
<h3 id="orgb2d4ec1">EEPROM (U6)</h3>
<div class="outline-text-3" id="text-orgb2d4ec1">
<p>
位於 <code>U6</code> 的 IC 則是 <a href="http://ww1.microchip.com/downloads/en/DeviceDoc/24AA02E48-24AA025E48-24AA02E64-24AA025E64-Data-Sheet-20002124H.pdf" target="_blank" rel="noopener">Microchip 24AA025E48T-I/OTCT-ND</a> ，這是一顆具有 2kbit (256 bytes) 大小的 EEPROM，一樣是透過 I2C 界面和處理器系統(Processing System, PS) 連接，其 I2C 位址為 <code>0xA2</code> 。
</p>

<p>
這顆 EEPROM 預設的設定是用來存取網路需要使用到的 MAC Address, 但是由於空間足夠，因此我們也可以將一些設定放置到這個 EEPROM 去。
</p>


<div class="figure">
<p><img src="ps_eeprom.png"  />
</p>
</div>
</div>
</div>

<div id="outline-container-org5289f86" class="outline-3">
<h3 id="org5289f86">JTAG Debug Interfaces</h3>
<div class="outline-text-3" id="text-org5289f86">
<p>
這塊板子具有兩個 <a href="https://en.wikipedia.org/wiki/JTAG" target="_blank" rel="noopener">JTAG</a> 界面，一個是透過 USB，另外一個則是傳統的 JTAG 接腳 (14p 牛頭母座)
</p>


<div class="figure">
<p><img src="jtag.png"  />
</p>
</div>

<p>
我們可以透過 <code>JP12</code> 來選擇當前的 JTAG 燒錄模式，看是要對 SOM (UltraZed-EG 核心板) 使用，還是對 SOM 以及 FMC 界面使用。
</p>

<p>
預設為 <code>JP12</code> 的腳位 <code>2-3</code> 短路，這種情況下 JTAG 只會針對 SOM 進行運作。
</p>


<div class="figure">
<p><img src="jtag_sel.png"  />
</p>
</div>
</div>
</div>

<div id="outline-container-orgcab8163" class="outline-3">
<h3 id="orgcab8163">Display Port (P2)</h3>
<div class="outline-text-3" id="text-orgcab8163">
<p>
<a href="http://ultrazed.org/product/ultrazed-eg-pcie-carrier-card" target="_blank" rel="noopener">UltraZed PCIe Carrier Card</a> 雖然沒有 HDMI 或是 VGA 可以輸出畫面，作為替代的則是加入了 <a href="https://en.wikipedia.org/wiki/DisplayPort" target="_blank" rel="noopener">DisplayPort</a> 來作為圖形顯示的輸出，我們可以將其接到支援 DisplayPort 輸入的螢幕上來進行畫面的顯示，或是購買 <code>DP 轉 VGA</code> 的線材來透過 VGA 將影像輸出。
</p>


<div class="figure">
<p><img src="dp.png"  />
</p>
</div>

<p>
注意到如果使用 <code>DP 轉 HDMI</code> 的線材可能會因為 <a href="https://www.xilinx.com/support/answers/67462.html" target="_blank" rel="noopener">AR# 67462</a> 的關係，無法透過 HDMI 將畫面順利顯示出來，因此建議還是購買 <code>DP 轉 VGA</code> 的線材比較好。
</p>

<p>
(我在這塊板子測試 DP 轉 HDMI 沒有畫面顯示 Orz&#x2026;)
</p>


<div class="figure">
<p><img src="ar67462.png"  />
</p>
</div>
</div>
</div>

<div id="outline-container-orgb18ddda" class="outline-3">
<h3 id="orgb18ddda">PCIe Edge Connector (P1)</h3>
<div class="outline-text-3" id="text-orgb18ddda">
<p>
位於 <code>P1</code> 的 PCIe 接腳就是這塊板子為何會冠以 PCIe 之名的理由。這個 PCIe 界面連接到了處理器系統 (Processing System, PS) 上的 GTR transceiver，這是一個可以支援速度高達 6.0Gb/s 的高速傳輸界面，並可以支援 PCIe, SATA, USB 3.0, SGMII 和 DisplayPort 等訊號傳輸。
</p>

<p>
在這邊我們使用到的是 GTR[0] ，並將其定義成 PCIe Gen2 的界面, 因此速度會調整成 5.0Gb/s。
</p>


<div class="figure">
<p><img src="pcie.png"  width="60%" />
</p>
</div>
</div>
</div>

<div id="outline-container-org97960e1" class="outline-3">
<h3 id="org97960e1">LVDS Touch Panel Interface (P3)</h3>
<div class="outline-text-3" id="text-org97960e1">
<p>
如果你有購買 <a href="https://www.avnet.com" target="_blank" rel="noopener">AVNET</a> 公司的 <a href="http://picozed.org/product/10-inch-touch-display-kit" target="_blank" rel="noopener">10-inch Touch Display Kit</a> 的話，則可以將其接到 P3 這個位置上。
</p>

<p>
(不過我沒有，所以這邊一樣不多做涉獵)
</p>


<div class="figure">
<p><img src="p3.png"  />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org6e6c731" class="outline-2">
<h2 id="org6e6c731">延伸閱讀</h2>
<div class="outline-text-2" id="text-org6e6c731">
<ul class="org-ul">
<li><a href="https://www.xilinx.com/support/documentation/data_sheets/ds890-ultrascale-overview.pdf" target="_blank" rel="noopener">DS890: UltraScale Architecture and Product Data Sheet: Overview.pdf</a></li>

<li><a href="https://www.avnet.com/opasdata/d120001/medias/docus/138/AES-ZU3EGES-1-SK-G-UltraZed-SOM-Designers-Guide-v1-1.pdf" target="_blank" rel="noopener">Avnet UltraZed-EG SOM Designer's Guide.pdf</a></li>

<li><a href="https://www.xilinx.com/products/silicon-devices/soc/zynq-ultrascale-mpsoc.html" target="_blank" rel="noopener">Xilinx ZYNQ UltraSCALE+ MPSoC</a></li>

<li><a href="https://www.avnet.com/wps/portal/us/resources/technical-articles/article/technologies/boards+and+modules/working-with-the-ultrazed+som-and-pcie-carrier-card" target="_blank" rel="noopener">Working with the UltraZed SoM &amp; PCIe Carrier Card</a></li>

<li><a href="http://zedboard.org/sites/default/files/documentations/5264-UG-AES-ZU3EGES-1-SOM-G-v1-1-V1.pdf" target="_blank" rel="noopener">UltraZed-EG SOM Hardware User Guide.pdf</a></li>

<li><a href="http://zedboard.org/sites/default/files/documentations/5265-AES-UG-ZU-PCIECC-G-UltraZed-EG-PCIe-v1_1.pdf" target="_blank" rel="noopener">UltraZed PCIe Carrier Card Hardware User Guide.pdf</a></li>

<li><a href="https://www.xilinx.com/support/documentation/user_guides/ug1085-zynq-ultrascale-trm.pdf" target="_blank" rel="noopener">ug1085: Zynq UntraScale+ Device Technical Reference Manual.pdf</a></li>

<li><a href="https://www.xilinx.com/support/answers/65463.html" target="_blank" rel="noopener">AR# 65463: Zynq UltraScale+ MPSoC - What devices are supported for configuration?</a></li>

<li><a href="https://qiita.com/PALLETS_FPGA/items/f8fc5c5ea21cfa8b0c1c" target="_blank" rel="noopener">FPGAとその周辺の電源についての動畫でのサポート</a></li>
</ul>
</div>
</div>
</div>
</span>
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/fpga/" rel="tag">#fpga</a>
          
            <a href="/tags/xilinx/" rel="tag">#xilinx</a>
          
            <a href="/tags/zynqmp/" rel="tag">#zynqmp</a>
          
            <a href="/tags/ultrazed-3eg-pciecc/" rel="tag">#ultrazed-3eg-pciecc</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-prev post-nav-item">
            
              <a href="/2c97574c/" rel="prev">UltraZed-EG PCIe Carrier Card 開發紀錄: 讓 Vivado 有 UltraZed-EG PCIe Carrier Card 的設定檔</a>
            
          </div>

          <div class="post-nav-next post-nav-item">
            
              <a href="/ff159f7c/" rel="next">在 Linux 下掛載 SD 卡映像檔</a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

 </div>

        
          <div class="comments" id="comments">
            
               <div id="gitalk-container"></div>
            
          </div>
        
      </div>

      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目錄
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            本站概覽
          </li>
        </ul>
      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="https://schema.org/Person">
          <img class="site-author-image" src="https://www.gravatar.com/avatar/bda0c97c8dca6eb45824d1b83f477ad9" alt="Yen-Chin, Lee" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Yen-Chin, Lee</p>
        </div>
        <p class="site-description motion-element" itemprop="description"></p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">134</span>
              <span class="site-state-item-name">文章</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">16</span>
              <span class="site-state-item-name">分類</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">103</span>
              <span class="site-state-item-name">標籤</span>
              </a>
          </div>

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/rss.xml" rel="alternate">
              <i class="menu-item-icon icon-next-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/coldnew" target="_blank">github</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://plus.google.com/u/0/106837301382084981260/posts" target="_blank">google+</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.linkedin.com/in/coldnew/" target="_blank">linkedln</a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      
        <section class="post-toc-wrap sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator"></div>
          <div class="post-toc">
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#org1e5c43b"><span class="nav-text">開發板概觀</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org24082e6"><span class="nav-text">UltraZed-EG</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#orgcc8ba3c"><span class="nav-text">SW2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgef7ae94"><span class="nav-text">QSPI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgb7a85a3"><span class="nav-text">eMMC</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#orgba514f7"><span class="nav-text">UltraZed-EG PCIe Carrier Card</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#orgdf38797"><span class="nav-text">概觀</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org3cbf9e6"><span class="nav-text">USB 2.0&#x2F;3.0 (J4)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgeef68b5"><span class="nav-text">1000Mb&#x2F;s 網路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgbe8f607"><span class="nav-text">SATA3 Host</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orge50f3b6"><span class="nav-text">USB 轉 UART (J2)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgdc1c982"><span class="nav-text">MicroSD 卡座 (J1)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgfd98078"><span class="nav-text">User LED D1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org209a8a2"><span class="nav-text">User LED D12 ~ D19</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgc328f6a"><span class="nav-text">User Switch SW1 ~ SW5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgfcb3838"><span class="nav-text">SOM Reset Input (SW6)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgd365d61"><span class="nav-text">PS PMOD (JP5)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org71fd29f"><span class="nav-text">PL PMOD (JA, JB)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org759eb3b"><span class="nav-text">FMC Header JX1, 2 CON1A-E</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org4f8c87b"><span class="nav-text">Clock Generator (U5)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgb2d4ec1"><span class="nav-text">EEPROM (U6)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org5289f86"><span class="nav-text">JTAG Debug Interfaces</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgcab8163"><span class="nav-text">Display Port (P2)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgb18ddda"><span class="nav-text">PCIe Edge Connector (P1)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org97960e1"><span class="nav-text">LVDS Touch Panel Interface (P3)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org6e6c731"><span class="nav-text">延伸閱讀</span></a></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator"></div>
        </section>
      

    </div>
  </aside>


    </main>

    <footer id="footer" class="container">
      <div class="footer">
        <div class="footer-inner"> 
<div class="copyright" >
  
  Copyright  &copy; &nbsp;  2012 - 
  <span itemprop="copyrightYear">2020</span>
  <span class="author" itemprop="copyrightHolder">Yen-Chin, Lee</span>
   &middot;  Powered by  <a href="https://github.com/coldnew/hexo-renderer-org" target="_blank">coldnew/hexo-renderer-org</a>
</div>

<!--
<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 強力驅動
</div>

<div class="theme-info">
  主題 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="noopener">
    NexT.Mist
  </a>
</div>
-->


 </div>
      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <!-- <script type="text/javascript" src="/vendors/jquery/dist/jquery.min.js"></script> -->
  <!-- <link rel="stylesheet" href="/vendors/bootstrap/dist/css/bootstrap.min.css" type="text/css"> -->
  <!-- <script type="text/javascript" src="/vendors/bootstrap/dist/js/bootstrap.min.js"></script> -->

  
  
  
    
  
  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>




  <script type="text/javascript" src="/js/nav-toggle.js?v=0.4.5.1"></script>
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  
<script type="text/javascript" src="/js/bootstrap.scrollspy.js?v=0.4.5.1" id="bootstrap.scrollspy.custom"></script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 0.4 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    var $tocContent = $('.post-toc-content');
    if (isDesktop() && CONFIG.sidebar === 'post') {
      if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
        displaySidebar();
      }
    }
  });
</script>



  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
      if (isMobile()) {
        FastClick.attach(document.body);
      }
    });
  </script>

  

  
  


  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>
  <script type="text/javascript" src="/js/app.js"></script>

<!-- LOCAL: You can save these files to your site and update links -->
  
  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<!-- END LOCAL -->
    
      <script type="text/javascript">
      function renderGitalk(){
        var gitalk = new Gitalk({
            owner: 'coldnew',
            repo: 'coldnew.github.io',
            clientID: 'b68fc8fd50fcc051b95e',
            clientSecret: '7f005263788db4a303b57e8296bb6800de1f9acf',
            admin: 'coldnew',
            
              distractionFreeMode: 'true'
            
            });
        gitalk.render('gitalk-container');
      }
      renderGitalk();
      </script>
    

</body>
</html>
